<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>賭け謎解きイベント</title>
  <link rel="stylesheet" href="app/styles/main.css">
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-analytics-compat.js"></script>
</head>
<body>
  <div class="container">
    <header>
      <h1>賭け謎解きイベント</h1>
      <div id="user-info"></div>
      <div id="master-button-container" class="master-button-container">
        <button id="master-button" class="master-button">マスター画面</button>
      </div>
    </header>

    <main>
      <!-- プレイヤー名入力フォーム -->
      <div id="player-name-container">
        <h2>ゲームに参加する</h2>
        <form id="player-name-form">
          <div class="form-group">
            <label for="player-name-input">あなたの名前</label>
            <input type="text" id="player-name-input" required placeholder="名前を入力してください">
          </div>
          <button type="submit">参加する</button>
        </form>
      </div>

      <!-- ゲーム画面 -->
      <div id="dashboard" style="display: none;">
        <div class="dashboard-section">
          <h2>プレイヤー情報</h2>
          <div id="player-info">
            <p>名前: <span id="player-name-display"></span></p>
            <p>総合得点: <span id="total-points">0</span>ポイント</p>
          </div>
        </div>

        <div class="dashboard-section">
          <h2>賭け投票</h2>
          <div id="betting-container">
            <h3>予想対象：謎解き本番で1位になる人物</h3>
            <form id="betting-form">
              <div class="form-group">
                <label for="betting-target">予想する人</label>
                <select id="betting-target">
                  <!-- JavaScriptで動的に読み込み -->
                </select>
              </div>
              <div class="form-group">
                <label for="betting-points">賭けるポイント</label>
                <input type="number" id="betting-points" min="1" value="1">
              </div>
              <button type="submit">賭ける</button>
            </form>
            <div id="current-bets">
              <h3>現在の賭け状況</h3>
              <ul id="bets-list"></ul>
            </div>
          </div>
        </div>

        <div class="dashboard-section">
          <h2>謎解きゲーム</h2>
          <div id="puzzle-container">
            <div id="puzzle-status">
              <p>状態: <span id="game-status">準備中</span></p>
              <p>残り時間: <span id="timer">30:00</span></p>
            </div>
            <div id="puzzle-content">
              <!-- ゲーム開始時に問題が表示される -->
              <p>ゲームが始まるのをお待ちください...</p>
            </div>
            <div id="puzzle-input" style="display: none;">
              <form id="answer-form">
                <div class="form-group">
                  <label for="answer">解答:</label>
                  <input type="text" id="answer">
                </div>
                <button type="submit">解答する</button>
              </form>
            </div>
            <div id="hints-shop" style="display: none;">
              <h3>ヒント</h3>
              <div id="available-hints">
                <!-- ヒント一覧が動的に表示される -->
              </div>
            </div>
          </div>
        </div>

        <div class="dashboard-section">
          <h2>ランキング</h2>
          <div id="rankings">
            <h3>総合ポイントランキング</h3>
            <ol id="rankings-list"></ol>
          </div>
        </div>
        
        <div class="player-actions">
          <button id="logout-button">別の名前で参加する</button>
        </div>
      </div>

      <!-- マスター画面 -->
      <div id="master-dashboard" style="display: none;">
        <div class="dashboard-section">
          <h2>マスター管理画面</h2>
          <div class="access-form" id="master-access-form">
            <div class="form-group">
              <label for="master-password">マスターパスワード</label>
              <input type="password" id="master-password" placeholder="パスワードを入力">
            </div>
            <button id="master-login-button" type="button">ログイン</button>
          </div>

          <div id="master-controls" style="display: none;">
            <div class="master-section">
              <h3>ゲーム管理</h3>
              <div class="form-group">
                <label for="game-status-select">ゲーム状態</label>
                <select id="game-status-select">
                  <option value="preparing">準備中</option>
                  <option value="active">進行中</option>
                  <option value="paused">一時停止</option>
                  <option value="finished">終了</option>
                </select>
              </div>
              <div class="form-group">
                <label for="time-remaining">残り時間 (秒)</label>
                <input type="number" id="time-remaining" min="0" value="1800">
              </div>
              <button id="update-game-status" type="button">ゲーム状態を更新</button>
            </div>

            <div class="master-section">
              <h3>謎解き問題管理</h3>
              <div class="form-group">
                <label for="puzzle-title">問題タイトル</label>
                <input type="text" id="puzzle-title" placeholder="タイトルを入力">
              </div>
              <div class="form-group">
                <label for="puzzle-description">問題内容</label>
                <textarea id="puzzle-description" rows="5" placeholder="問題の説明を入力"></textarea>
              </div>
              <div class="form-group">
                <label for="puzzle-image-url">画像URL (オプション)</label>
                <input type="text" id="puzzle-image-url" placeholder="画像のURLを入力">
              </div>
              <div class="form-group">
                <label for="puzzle-answer">正解</label>
                <input type="text" id="puzzle-answer" placeholder="正解を入力">
              </div>
              <button id="create-puzzle" type="button">問題を作成/更新</button>
            </div>

            <div class="master-section">
              <h3>ヒント管理</h3>
              <div id="hints-manager">
                <div class="hint-form">
                  <div class="form-group">
                    <label for="hint-title">ヒントタイトル</label>
                    <input type="text" id="hint-title" placeholder="ヒントのタイトル">
                  </div>
                  <div class="form-group">
                    <label for="hint-content">ヒント内容</label>
                    <textarea id="hint-content" rows="3" placeholder="ヒントの内容"></textarea>
                  </div>
                  <div class="form-group">
                    <label for="hint-cost">コスト</label>
                    <input type="number" id="hint-cost" min="1" value="10">
                  </div>
                  <button id="add-hint" type="button">ヒントを追加</button>
                </div>
                <div id="hints-list" class="hints-list">
                  <!-- ヒント一覧が表示される -->
                </div>
              </div>
            </div>

            <div class="master-section">
              <h3>結果管理</h3>
              <button id="calculate-results" type="button">結果を計算</button>
              <div id="results-display" class="results-display">
                <!-- 結果が表示される -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <footer>
      <p>&copy; 2024 賭け謎解きイベント</p>
    </footer>
  </div>

  <!-- JavaScript -->
  <script src="app/utils/firebase.js"></script>
  <script src="app/utils/player.js"></script>
  <script src="app/components/dashboard.js"></script>
  <script src="app/components/betting.js"></script>
  <script src="app/components/puzzle.js"></script>
  <script src="app/components/rankings.js"></script>
  <script src="app/components/master.js"></script>
  <script src="app/main.js"></script>
</body>
</html> 